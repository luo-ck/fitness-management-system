import{_ as z,u as B,r as C,c as E,o as V,a as M,b as _,d as e,w as s,e as n,f as O,E as R,g as h,h as f,t as U,i as d,j as p,k,v as q,p as K,l as L}from"./index-9NtTeuWa.js";const P={class:"dashboard-container"},F={class:"dashboard-title"},G={class:"user-info"},H={class:"card-title"},J={key:0,class:"loading-container"},Q={key:1,class:"empty-container"},W={key:2,class:"students-table"},X={__name:"CoachDashboard",setup(Y){const c=M(),m=B(),v=C(!1),u=C([]),b=E(()=>m.currentUser),y=a=>Array.isArray(a)?a.map(t=>y(t)):a!==null&&typeof a=="object"&&a.constructor===Object?Object.keys(a).reduce((t,o)=>{const r=o.replace(/_([a-z])/g,(g,w)=>w.toUpperCase());return t[r]=y(a[o]),t},{}):a,A=async()=>{v.value=!0;try{const a=await O.get(`/user-coaches/coach/${b.value.coachId}`);console.log("Raw students data:",a.data);const t=a.data,o=Array.isArray(t)?t:t&&t.data&&Array.isArray(t.data)?t.data:[];u.value=y(o),console.log("Camel case students data:",u.value)}catch(a){R.error("获取学员列表失败"),console.error("获取学员列表失败:",a),u.value=[{userId:1,username:"testuser",name:"测试用户",age:25,gender:"男",goal:"减脂",contact:"13800138000"}]}finally{v.value=!1}},I=a=>{c.push(`/coach/student/${a}`)},D=()=>{c.push("/coach/profile")},S=a=>{c.push({path:"/coach/chat",query:{otherId:a.userId,otherName:a.name||a.username,otherType:"user"}})},x=()=>{m.logout(),c.push("/coach/login")};return V(()=>{if(!m.isAuthenticated){c.push("/coach/login");return}A()}),(a,t)=>{const o=n("el-icon"),r=n("el-button"),g=n("el-card"),w=n("el-skeleton"),N=n("el-empty"),l=n("el-table-column"),T=n("el-table");return h(),_("div",P,[e(g,{class:"dashboard-header",shadow:"hover"},{header:s(()=>[f("div",F,[e(o,null,{default:s(()=>[e(p(k))]),_:1}),t[0]||(t[0]=d(" 教练控制台 ",-1))])]),default:s(()=>{var i;return[f("div",G,[f("span",null,"欢迎您，"+U((i=b.value)==null?void 0:i.name),1),e(r,{onClick:D},{default:s(()=>[e(o,null,{default:s(()=>[e(p(k))]),_:1}),t[1]||(t[1]=d(" 我的 ",-1))]),_:1}),e(r,{type:"danger",onClick:x},{default:s(()=>[...t[2]||(t[2]=[d("退出登录",-1)])]),_:1})])]}),_:1}),e(g,{class:"students-card",shadow:"hover"},{header:s(()=>[f("div",H,[e(o,null,{default:s(()=>[e(p(L))]),_:1}),t[3]||(t[3]=d(" 我的学员列表 ",-1))])]),default:s(()=>[v.value?(h(),_("div",J,[e(w,{rows:5,animated:""})])):u.value.length===0?(h(),_("div",Q,[e(N,{description:"暂无学员"})])):(h(),_("div",W,[e(T,{data:u.value,stripe:"",style:{width:"100%"}},{default:s(()=>[e(l,{prop:"userId",label:"学员ID",width:"80"}),e(l,{prop:"username",label:"用户名",width:"120"}),e(l,{prop:"name",label:"姓名",width:"120"}),e(l,{prop:"age",label:"年龄",width:"80"}),e(l,{prop:"gender",label:"性别",width:"80"}),e(l,{prop:"goal",label:"训练目标",width:"120"}),e(l,{prop:"contact",label:"联系方式",width:"150"}),e(l,{label:"操作",width:"200"},{default:s(i=>[e(r,{type:"primary",size:"small",onClick:$=>I(i.row.userId)},{default:s(()=>[e(o,null,{default:s(()=>[e(p(q))]),_:1}),t[4]||(t[4]=d(" 查看详情 ",-1))]),_:1},8,["onClick"]),e(r,{type:"info",size:"small",onClick:$=>S(i.row)},{default:s(()=>[e(o,null,{default:s(()=>[e(p(K))]),_:1}),t[5]||(t[5]=d(" 联系学员 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]))]),_:1})])}}},j=z(X,[["__scopeId","data-v-23f0887a"]]);export{j as default};

import{_ as J,r as f,c as K,n as O,o as Q,B as X,b as c,h as p,d as t,w as a,e as u,f as w,a as Y,g as i,i as d,j as _,q as Z,s as ee,t as N,x as te,y as U,C as ae,A as le,v as ne,D as oe,E as y,G as se}from"./index-CE4dHlk9.js";const re={class:"training-plans-container"},ie={class:"back-button-container"},de={key:0,class:"loading-container"},ce={key:1,class:"plan-detail-content"},ue={key:0,class:"exercises-list"},pe={key:1},_e={key:1,class:"empty-exercises"},ve={class:"dialog-footer"},fe={class:"plans-title"},me={class:"plans-info"},we={key:0,class:"loading-container"},ye={key:1,class:"empty-container"},ge={key:2,class:"plans-table"},he={__name:"CoachTrainingPlans",setup(ke){const z=O(),b=Y(),C=f(!1),x=f(""),g=f([]),h=f(!1),D=f(!1),v=f(null),m=K(()=>z.params.userId),E={1:"跑步",2:"游泳",3:"举重",4:"俯卧撑",5:"仰卧起坐",6:"深蹲",7:"引体向上",8:"跳绳",9:"平板卧推"},L=(l,e,n)=>n?new Date(n).toLocaleDateString("zh-CN"):"",M=l=>l?new Date(l).toLocaleDateString("zh-CN"):"",R=l=>E[l]||`运动${l}`,S=async l=>{try{D.value=!0;const e=await w.get(`/training-plans/${l}`);console.log("获取到的计划详情响应:",e),v.value=e.data}catch(e){console.error("获取计划详情失败:",e),y.error("获取计划详情失败")}finally{D.value=!1}},A=async()=>{try{const e=(await w.get(`/users/${m.value}`)).data;x.value=e.name||e.username}catch(l){console.error("获取学员名称失败:",l),x.value="未知学员"}},$=async()=>{try{C.value=!0;const e=(await w.get(`/training-plans/student/${m.value}`)).data;console.log("获取到的训练计划列表:",e),g.value=e}catch(l){console.error("获取训练计划失败:",l),g.value=[{planId:1,planDate:"2025-12-22T00:00:00",exerciseCount:3},{planId:2,planDate:"2025-12-21T00:00:00",exerciseCount:4}]}finally{C.value=!1}},I=(l=null)=>{l?b.push(`/coach/student/${m.value}/plan/${l}`):b.push(`/coach/student/${m.value}/plan`)},j=l=>{h.value=!0,S(l)},q=async l=>{try{await se.confirm("确定要删除这个训练计划吗？此操作不可恢复。","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await w.delete(`/training-plans/${l}`),y.success("训练计划删除成功"),$()}catch(e){e!=="cancel"&&(console.error("删除训练计划失败:",e),y.error("删除失败，请重试"))}},F=async l=>{try{const n=(await w.get(`/trainer/videos/${l}`)).data;if(n&&n.videoUrl){const o=n.videoUrl,k=o.startsWith("http")?new URL(o).pathname:o;window.open(k,"_blank")}else y.error("视频URL无效")}catch(e){console.error("获取视频信息失败:",e),y.error("获取视频信息失败")}},G=()=>{b.push(`/coach/student/${m.value}`)};return Q(()=>{A(),$()}),X(()=>{$()}),(l,e)=>{const n=u("el-icon"),o=u("el-button"),k=u("el-skeleton"),W=u("el-divider"),r=u("el-table-column"),P=u("el-table"),T=u("el-empty"),H=u("el-dialog"),V=u("el-card");return i(),c("div",re,[p("div",ie,[t(o,{onClick:G},{default:a(()=>[t(n,null,{default:a(()=>[t(_(Z))]),_:1}),e[2]||(e[2]=d(" 返回 ",-1))]),_:1})]),t(H,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=s=>h.value=s),title:"训练计划详情",width:"800px"},{footer:a(()=>[p("div",ve,[t(o,{onClick:e[0]||(e[0]=s=>h.value=!1)},{default:a(()=>[...e[5]||(e[5]=[d("关闭",-1)])]),_:1})])]),default:a(()=>[D.value?(i(),c("div",de,[t(k,{rows:8,animated:""})])):v.value?(i(),c("div",ce,[p("h3",null,"训练计划 "+N(M(v.value.planDate)),1),t(W),e[4]||(e[4]=p("h4",null,"运动项目列表",-1)),v.value.exercises&&v.value.exercises.length>0?(i(),c("div",ue,[t(P,{data:v.value.exercises,style:{width:"100%"}},{default:a(()=>[t(r,{prop:"orderIndex",label:"序号",width:"80"}),t(r,{label:"运动名称",width:"120"},{default:a(s=>[d(N(R(s.row.exerciseId)),1)]),_:1}),t(r,{prop:"sets",label:"组数",width:"100"}),t(r,{prop:"reps",label:"次数",width:"100"}),t(r,{prop:"duration",label:"时长(分钟)",width:"120"}),t(r,{label:"教学视频",width:"150"},{default:a(s=>[s.row.videoId?(i(),te(o,{key:0,type:"primary",size:"small",link:"",onClick:B=>F(s.row.videoId)},{default:a(()=>[...e[3]||(e[3]=[d(" 查看视频 ",-1)])]),_:1},8,["onClick"])):(i(),c("span",pe,"无"))]),_:1})]),_:1},8,["data"])])):(i(),c("div",_e,[t(T,{description:"暂无运动项"})]))])):ee("",!0)]),_:1},8,["modelValue"]),t(V,{class:"plans-header-card",shadow:"hover"},{header:a(()=>[p("div",fe,[t(n,null,{default:a(()=>[t(_(ae))]),_:1}),e[6]||(e[6]=d(" 训练计划管理 ",-1))])]),default:a(()=>[p("div",me,[p("h3",null,"学员："+N(x.value||"加载中..."),1),t(o,{type:"primary",onClick:I},{default:a(()=>[t(n,null,{default:a(()=>[t(_(U))]),_:1}),e[7]||(e[7]=d(" 创建新计划 ",-1))]),_:1})])]),_:1}),t(V,{class:"plans-list-card",shadow:"hover"},{header:a(()=>[...e[8]||(e[8]=[p("div",{class:"card-subtitle"},"训练计划列表",-1)])]),default:a(()=>[C.value?(i(),c("div",we,[t(k,{rows:5,animated:""})])):g.value.length===0?(i(),c("div",ye,[t(T,{description:"暂无训练计划"}),t(o,{type:"primary",onClick:I,style:{"margin-top":"20px"}},{default:a(()=>[t(n,null,{default:a(()=>[t(_(U))]),_:1}),e[9]||(e[9]=d(" 创建首个训练计划 ",-1))]),_:1})])):(i(),c("div",ge,[t(P,{data:g.value,stripe:"",style:{width:"100%"}},{default:a(()=>[t(r,{prop:"planId",label:"计划ID",width:"80"}),t(r,{prop:"planDate",label:"训练日期",width:"150",formatter:L}),t(r,{prop:"exerciseCount",label:"运动项目",width:"120"}),t(r,{label:"操作",width:"250"},{default:a(s=>[t(o,{type:"primary",size:"small",onClick:B=>I(s.row.planId)},{default:a(()=>[t(n,null,{default:a(()=>[t(_(le))]),_:1}),e[10]||(e[10]=d(" 编辑 ",-1))]),_:1},8,["onClick"]),t(o,{type:"success",size:"small",onClick:B=>j(s.row.planId)},{default:a(()=>[t(n,null,{default:a(()=>[t(_(ne))]),_:1}),e[11]||(e[11]=d(" 查看详情 ",-1))]),_:1},8,["onClick"]),t(o,{type:"danger",size:"small",onClick:B=>q(s.row.planId)},{default:a(()=>[t(n,null,{default:a(()=>[t(_(oe))]),_:1}),e[12]||(e[12]=d(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]))]),_:1})])}}},Ce=J(he,[["__scopeId","data-v-42712d54"]]);export{Ce as default};

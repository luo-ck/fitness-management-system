import{_ as ne,r as g,m as re,c as de,n as ie,o as ce,b as c,h as l,d as t,w as s,e as i,f as w,E as b,a as ue,g as d,i as n,j as D,q as _e,s as pe,t as r,x as A,k as fe,y as ve,F as M,z as j,A as ge,v as me}from"./index-htIitFyt.js";const he={class:"student-detail-container"},be={class:"back-button-container"},ye={key:0,class:"loading-container"},ke={key:1,class:"plan-detail-content"},we={key:0,class:"exercises-list"},De={key:1},xe={key:1,class:"empty-exercises"},Ie={class:"dialog-footer"},Ce={class:"card-title"},$e={class:"contact-info"},Ve={class:"tab-content"},Te={class:"tab-header"},Pe={key:0,class:"loading-container"},Se={key:1,class:"empty-container"},Ue={key:2,class:"plans-list"},Le={class:"plan-header"},Ne={class:"plan-title"},Ae={class:"plan-actions"},Be={class:"plan-content"},ze={class:"tab-content"},Ee={key:0,class:"loading-container"},Re={key:1,class:"empty-container"},Fe={key:2,class:"feedback-list"},Oe={class:"feedback-header"},qe={class:"feedback-title"},Me={class:"feedback-content"},je={__name:"CoachStudentDetail",setup(Je){const J=ie(),$=ue(),V=g("plans"),B=g(!1),T=g(!1),P=g(!1),_=re({userId:null,username:"",name:"",age:null,gender:"",height:null,weight:null,contact:"",goal:""}),x=g([]),I=g([]),C=g(!1),S=g(!1),m=g(null),h=de(()=>J.params.userId),W={1:"跑步",2:"游泳",3:"举重",4:"俯卧撑",5:"仰卧起坐",6:"深蹲",7:"引体向上",8:"跳绳",9:"平板卧推"},k=a=>a?new Date(a).toLocaleDateString("zh-CN"):"",G=a=>W[a]||`运动${a}`,H=async a=>{try{S.value=!0;const e=await w.get(`/training-plans/${a}`);console.log("获取到的计划详情响应:",e),console.log("获取到的计划详情数据:",e.data),console.log("是否包含exercises字段:","exercises"in e.data),"exercises"in e.data&&(console.log("exercises数据:",e.data.exercises),console.log("exercises长度:",e.data.exercises.length)),m.value=e.data}catch(e){console.error("获取计划详情失败:",e),b.error("获取计划详情失败")}finally{S.value=!1}},K=async()=>{try{B.value=!0;const e=(await w.get(`/users/${h.value}`)).data;Object.assign(_,e)}catch(a){b.error("获取学员信息失败"),console.error("获取学员信息失败:",a)}finally{B.value=!1}},z=async()=>{try{T.value=!0;const e=(await w.get(`/training-plans/student/${h.value}`)).data;console.log("获取到的训练计划列表:",e),x.value=e}catch(a){console.error("获取训练计划失败:",a),x.value=[{planId:1,planDate:"2025-12-22T00:00:00",exerciseCount:3},{planId:2,planDate:"2025-12-21T00:00:00",exerciseCount:4}]}finally{T.value=!1}},E=async()=>{try{P.value=!0,console.log("=== 开始获取训练反馈 ==="),console.log("学员ID:",h.value),console.log("API URL:",`/feedback/student/${h.value}`);const a=await w.get(`/feedback/student/${h.value}`);console.log("=== 获取训练反馈成功 ==="),console.log("响应状态:",a.status),console.log("响应数据:",a.data);const e=a.data,u=(Array.isArray(e)?e:[e]).map(p=>({feedbackId:p.feedbackId||0,feedbackDate:p.feedbackDate||new Date().toISOString(),planDate:p.planDate||new Date().toISOString(),feeling:p.feeling||"未填写",rating:p.rating||0,comments:p.comments||"未填写"}));I.value=u,console.log("=== 训练反馈数据处理完成 ==="),console.log("处理后的数据:",u)}catch(a){console.error("=== 获取训练反馈失败 ==="),console.error("错误类型:",typeof a),console.error("错误对象:",a),a.response?(console.error("响应状态:",a.response.status),console.error("响应数据:",a.response.data),console.error("响应头:",a.response.headers),b.error(`获取训练反馈失败，状态码: ${a.response.status}，原因: ${JSON.stringify(a.response.data)}`)):a.request?(console.error("请求已发送但未收到响应:",a.request),b.error("获取训练反馈失败，未收到服务器响应，请检查网络连接")):(console.error("请求配置错误:",a.message),b.error(`获取训练反馈失败: ${a.message}`)),console.error("错误配置:",a.config),I.value=[{feedbackId:1,feedbackDate:"2025-12-21T00:00:00",planDate:"2025-12-21T00:00:00",feeling:"感觉很好",rating:5,comments:"训练计划很合理，效果不错"}]}finally{P.value=!1,console.log("=== 获取训练反馈流程结束 ===")}},R=(a=null)=>{a?$.push(`/coach/student/${h.value}/plan/${a}`):$.push(`/coach/student/${h.value}/plan`)},Q=a=>{C.value=!0,H(a)},X=async a=>{try{const f=(await w.get(`/trainer/videos/${a}`)).data;if(f&&f.videoUrl){const u=f.videoUrl,p=u.startsWith("http")?new URL(u).pathname:u;window.open(p,"_blank")}else b.error("视频URL无效")}catch(e){console.error("获取视频信息失败:",e),b.error("获取视频信息失败")}},Y=()=>{$.push("/coach/dashboard")},Z=a=>{a==="plans"?z():a==="feedback"&&E()};return ce(()=>{K(),z(),V.value==="feedback"&&E()}),(a,e)=>{const f=i("el-icon"),u=i("el-button"),p=i("el-skeleton"),ee=i("el-divider"),y=i("el-table-column"),te=i("el-table"),U=i("el-empty"),ae=i("el-dialog"),v=i("el-descriptions-item"),L=i("el-descriptions"),F=i("el-col"),se=i("el-row"),N=i("el-card"),O=i("el-tab-pane"),le=i("el-rate"),oe=i("el-tabs");return d(),c("div",he,[l("div",be,[t(u,{onClick:Y},{default:s(()=>[t(f,null,{default:s(()=>[t(D(_e))]),_:1}),e[3]||(e[3]=n(" 返回 ",-1))]),_:1})]),t(ae,{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=o=>C.value=o),title:"训练计划详情",width:"800px"},{footer:s(()=>[l("div",Ie,[t(u,{onClick:e[0]||(e[0]=o=>C.value=!1)},{default:s(()=>[...e[6]||(e[6]=[n("关闭",-1)])]),_:1})])]),default:s(()=>[S.value?(d(),c("div",ye,[t(p,{rows:8,animated:""})])):m.value?(d(),c("div",ke,[l("h3",null,"训练计划 "+r(k(m.value.planDate)),1),t(ee),e[5]||(e[5]=l("h4",null,"运动项目列表",-1)),m.value.exercises&&Array.isArray(m.value.exercises)&&m.value.exercises.length>0?(d(),c("div",we,[t(te,{data:m.value.exercises,style:{width:"100%"}},{default:s(()=>[t(y,{prop:"orderIndex",label:"序号",width:"80"}),t(y,{label:"运动名称",width:"120"},{default:s(o=>[n(r(G(o.row.exerciseId)),1)]),_:1}),t(y,{prop:"sets",label:"组数",width:"100"}),t(y,{prop:"reps",label:"次数",width:"100"}),t(y,{prop:"duration",label:"时长(分钟)",width:"120"}),t(y,{label:"教学视频",width:"150"},{default:s(o=>[o.row.videoId?(d(),A(u,{key:0,type:"primary",size:"small",link:"",onClick:q=>X(o.row.videoId)},{default:s(()=>[...e[4]||(e[4]=[n(" 查看视频 ",-1)])]),_:1},8,["onClick"])):(d(),c("span",De,"无"))]),_:1})]),_:1},8,["data"])])):(d(),c("div",xe,[t(U,{description:"暂无运动项"})]))])):pe("",!0)]),_:1},8,["modelValue"]),t(N,{class:"student-info-card",shadow:"hover"},{header:s(()=>[l("div",Ce,[t(f,null,{default:s(()=>[t(D(fe))]),_:1}),e[7]||(e[7]=n(" 学员详情 ",-1))])]),default:s(()=>[t(se,{gutter:20},{default:s(()=>[t(F,{span:12},{default:s(()=>[t(L,{column:1,border:""},{default:s(()=>[t(v,{label:"学员ID"},{default:s(()=>[n(r(_.userId),1)]),_:1}),t(v,{label:"用户名"},{default:s(()=>[n(r(_.username),1)]),_:1}),t(v,{label:"姓名"},{default:s(()=>[n(r(_.name),1)]),_:1}),t(v,{label:"年龄"},{default:s(()=>[n(r(_.age||"-"),1)]),_:1})]),_:1})]),_:1}),t(F,{span:12},{default:s(()=>[t(L,{column:1,border:""},{default:s(()=>[t(v,{label:"性别"},{default:s(()=>[n(r(_.gender||"-"),1)]),_:1}),t(v,{label:"身高"},{default:s(()=>[n(r(_.height?_.height+" cm":"-"),1)]),_:1}),t(v,{label:"体重"},{default:s(()=>[n(r(_.weight?_.weight+" kg":"-"),1)]),_:1}),t(v,{label:"训练目标"},{default:s(()=>[n(r(_.goal||"-"),1)]),_:1})]),_:1})]),_:1})]),_:1}),l("div",$e,[t(L,{column:1,border:""},{default:s(()=>[t(v,{label:"联系方式"},{default:s(()=>[n(r(_.contact||"-"),1)]),_:1})]),_:1})])]),_:1}),t(oe,{modelValue:V.value,"onUpdate:modelValue":e[2]||(e[2]=o=>V.value=o),class:"student-tabs",onTabChange:Z},{default:s(()=>[t(O,{label:"训练计划",name:"plans"},{default:s(()=>[l("div",Ve,[l("div",Te,[e[9]||(e[9]=l("h3",null,"训练计划列表",-1)),t(u,{type:"primary",onClick:R},{default:s(()=>[t(f,null,{default:s(()=>[t(D(ve))]),_:1}),e[8]||(e[8]=n(" 创建训练计划 ",-1))]),_:1})]),T.value?(d(),c("div",Pe,[t(p,{rows:5,animated:""})])):x.value.length===0?(d(),c("div",Se,[t(U,{description:"暂无训练计划"})])):(d(),c("div",Ue,[(d(!0),c(M,null,j(x.value,o=>(d(),A(N,{key:o.planId,class:"plan-card",shadow:"hover"},{header:s(()=>[l("div",Le,[l("span",Ne,"训练计划 "+r(k(o.planDate)),1),l("div",Ae,[t(u,{type:"primary",size:"small",onClick:q=>R(o.planId)},{default:s(()=>[t(f,null,{default:s(()=>[t(D(ge))]),_:1}),e[10]||(e[10]=n(" 编辑 ",-1))]),_:1},8,["onClick"]),t(u,{type:"success",size:"small",onClick:q=>Q(o.planId)},{default:s(()=>[t(f,null,{default:s(()=>[t(D(me))]),_:1}),e[11]||(e[11]=n(" 查看详情 ",-1))]),_:1},8,["onClick"])])])]),default:s(()=>[l("div",Be,[l("p",null,"训练日期："+r(k(o.planDate)),1),l("p",null,"运动项目："+r(o.exerciseCount||0)+" 项",1)])]),_:2},1024))),128))]))])]),_:1}),t(O,{label:"训练反馈",name:"feedback"},{default:s(()=>[l("div",ze,[e[15]||(e[15]=l("div",{class:"tab-header"},[l("h3",null,"训练反馈列表")],-1)),P.value?(d(),c("div",Ee,[t(p,{rows:5,animated:""})])):I.value.length===0?(d(),c("div",Re,[t(U,{description:"暂无训练反馈"})])):(d(),c("div",Fe,[(d(!0),c(M,null,j(I.value,o=>(d(),A(N,{key:o.feedbackId,class:"feedback-card",shadow:"hover"},{header:s(()=>[l("div",Oe,[l("span",qe,"反馈："+r(k(o.feedbackDate)),1),t(le,{"model-value":o.rating,disabled:"","show-score":""},null,8,["model-value"])])]),default:s(()=>[l("div",Me,[l("p",null,[e[12]||(e[12]=l("strong",null,"感受：",-1)),n(r(o.feeling||"-"),1)]),l("p",null,[e[13]||(e[13]=l("strong",null,"评价：",-1)),n(r(o.comments||"-"),1)]),l("p",null,[e[14]||(e[14]=l("strong",null,"计划：",-1)),n("训练计划 "+r(k(o.planDate)),1)])])]),_:2},1024))),128))]))])]),_:1})]),_:1},8,["modelValue"])])}}},Ge=ne(je,[["__scopeId","data-v-accb1d92"]]);export{Ge as default};

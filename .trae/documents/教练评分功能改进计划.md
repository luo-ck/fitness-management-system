# 教练评分功能改进计划

## 1. 问题分析

### 1.1 当前问题
- **用户中心-我的教练**：绑定的教练名片中评分显示为 `0.0`，因为教练对象中没有 `rating` 属性
- **教练列表**：教练个人名片中缺少综合星级评分
- **查看评价按钮**：样式与旁边的"选择教练"按钮不一致

### 1.2 解决方案
- 调用 `coach-ratings/coach/{coachId}/average` API 获取每个教练的平均评分
- 在教练名片中显示星级评分
- 统一按钮样式

## 2. 实现步骤

### 2.1 修复用户中心-我的教练中的评分显示
1. 修改 `CoachStore`，添加获取教练评分的方法
2. 修改 `UserCenter.vue`，在获取教练列表后获取每个教练的评分
3. 在教练名片中显示正确的评分值

### 2.2 为教练列表添加综合星级评分
1. 修改 `CoachStore`，为 `allCoaches` 添加评分字段
2. 修改 `CoachList.vue`，在获取教练列表后获取每个教练的评分
3. 在教练名片中添加星级评分显示

### 2.3 调整"查看评价"按钮样式
1. 修改 `CoachList.vue` 中的"查看评价"按钮，移除 `size="small"` 属性
2. 调整按钮类型或颜色，使其与"选择教练"按钮样式一致

## 3. 技术实现

### 3.1 前端修改

#### 3.1.1 修改 CoachStore
- 在 `src/store/coachStore.js` 中添加获取教练评分的方法
- 修改 `fetchUserCoaches` 和 `fetchCoaches` 方法，获取并添加评分

#### 3.1.2 修改 UserCenter.vue
- 在教练名片中显示正确的评分值
- 添加星级评分组件

#### 3.1.3 修改 CoachList.vue
- 在教练名片中添加星级评分显示
- 调整"查看评价"按钮样式

### 3.2 后端 API
- 已存在 `coach-ratings/coach/{coachId}/average` API，无需修改

## 4. 预期效果

1. **用户中心-我的教练**：显示正确的教练评分
2. **教练列表**：每个教练名片显示综合星级评分
3. **按钮样式**："查看评价"按钮与"选择教练"按钮样式一致

## 5. 实现细节

### 5.1 评分显示格式
- 显示为 `X.X` 格式（如 4.5）
- 配合星级图标显示

### 5.2 按钮样式调整
- 统一按钮大小和类型
- 保持视觉一致性

### 5.3 性能优化
- 使用并发请求获取多个教练的评分
- 添加缓存机制，避免重复请求

## 6. 代码修改点

### 6.1 前端文件修改
- `src/store/coachStore.js`
- `src/views/UserCenter.vue`
- `src/views/CoachList.vue`

### 6.2 后端文件修改
- 无需修改

## 7. 测试计划

1. 测试用户中心-我的教练中的评分显示
2. 测试教练列表中的评分显示
3. 测试按钮样式一致性
4. 测试评分更新功能

## 8. 风险评估

- 风险：频繁调用评分 API 可能影响性能
- 解决方案：添加缓存机制，或在获取教练列表时一并返回评分

## 9. 依赖关系

- 依赖已有的教练评分 API
- 依赖 Element Plus 的 Star 组件

## 10. 实现时间

- 预计总时间：1-2 小时
- 代码修改：30-60 分钟
- 测试和调试：30 分钟

## 11. 质量保证

- 确保代码符合现有代码规范
- 确保功能正常运行
- 确保样式一致
- 确保性能良好

## 12. 后续维护

- 定期检查评分 API 的性能
- 根据用户反馈调整评分显示方式
- 优化评分缓存策略